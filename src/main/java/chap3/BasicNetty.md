# TCP粘包/拆包

## 粘包/拆包

TCP底层不了解上层业务数据的具体含义，只会根据TCP缓冲区实际情况进行包划分，在业务上认为一个完整的包可能会被TCP拆分为多个包进行发送，也有可能把多个小包封装成一个大的数据包发送。

### 原因

1. write写入的字节大小超过发送缓冲区的大小
2. 进行MSS大小的TCP分段
3. 以太网帧的payload大于MTU进行IP分片

### 解决策略：

1. 消息定长，不够以空格填充
2. 在包围增加CRLF进行分割
3. 将消息分为消息头和消息体
4. 更复杂的应用层协议

# 编解码技术

序列化的目的：

* 网络传输
* 对象持久化

## 原生Java序列化的缺陷

### 无法跨语言

### 序列化后的码流太大

### 序列化性能低

## 编码框架：

* Google——Protobuf
* Facebook——Thrift
* JBoss——Marshalling

